fragment_downloaded_cb({"url": "tutorial/ingester.html#cleaning-up-the-blog-posts", "fragment": "Cleaning up the blog posts \nIf you re creating an app from a website s content it s incongruous when it looks like the whole website is embedded inside the app. We want to get rid of all the theming and navigation elements on the web page so that we can later design a more unified style for our app s UI elements and its content. \nAlthough it would be possible to do this with traditional web scraping and DOM manipulation tools such as Cheerio we are going to use Fathom to clean up the content. Fathom is a fairly new technology that allows you to interpret an HTML document based on rules that you write. \nNOTE Both libingester and Fathom require a DOM library for processing the HTML. Unfortunately libingester works internally with Cheerio which is much faster than JSDOM but Fathom requires some features that Cheerio doesn t provide. Therefore we have to convert from one to the other and back again in our ingester. \nWe use a rule set based on Fathom s example Readability ruleset which scores paragraphs and paragraph like HTML nodes based on their likelihood to be part of the main text then picks the biggest cluster of high scoring nodes. \nFor brevity we ve omitted the imports and the functions scoreByLength scoreByImageSize byInverseLinkDensity and hasAncestor If you re running your own program as you re following along you can find them in the full code. \nRunning our ingester with npm start now shows the HTML in html html and html to be quite minimal. We ll do some final cleanup with Cheerio removing unused DOM attributes to keep the sizes of the posts as small as possible. After all our app may be downloaded by people with limited internet connections so we should try to optimize for that. \nOr even better just use the util.cleanup_body utility. It has good defaults so it already does all the above and more. And you can overwrite or extend the defaults if the pages you are ingesting needs a customized cleanup. \n"});